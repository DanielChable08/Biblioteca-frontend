<div class="full-container">
  
<div class="main-header">
    <div class="header-brand">
      <i class="pi pi-home brand-logo"></i>
      <div class="brand-info">
        <span class="brand-title">Biblioteca Física</span>
        <span class="admin-badge">Administrador</span>
        <div class="brand-subtitle">Panel de administración del catálogo físico</div>
      </div>
    </div>
    <div class="header-user-section">
      <div class="user-text">
        <span class="user-role">Bibliotecario(a)</span>
        <span class="user-name">Bibliotecario</span>
      </div>
      <div class="user-avatar">B</div>
    </div>
  </div>

  
  <div class="search-section">
    <div class="search-container">
      <i class="pi pi-search search-icon"></i>
      <input type="text" pInputText placeholder="Buscar libros, autores, temas..." class="main-search-input" [(ngModel)]="terminoBusqueda" />
    </div>
    
    <div class="custom-filter-dropdown-container" (click)="toggleDropdown()">
      <div class="custom-filter-dropdown-trigger">
        <i class="pi pi-filter"></i>
        <span>{{ getDropdownText() }}</span>
        <i class="pi pi-chevron-down" [class.rotated]="dropdownOpen"></i>
      </div>
      <div class="custom-filter-dropdown-panel" *ngIf="dropdownOpen">
        <div *ngFor="let categoria of categoriasLista" 
          class="filter-dropdown-option"
          [class.selected]="categoria.value === categoriaSeleccionada"
          (click)="selectCategoria(categoria.value); $event.stopPropagation()">
          <i [class]="categoria.icon"></i>
          <span>{{ categoria.label === 'Todas' ? 'Todas las categorías' : categoria.label }}</span>
          <b>({{ contadorCategorias[categoria.value] }})</b>
        </div>
      </div>
    </div>
  </div>


  <div class="info-stats-row">
    <span class="main-stat">{{ libros.length }} libros en catálogo</span>
    <span class="secondary-stat">Última actualización: Hoy</span>
    <span class="secondary-stat">Nuevos ingresos: 3 libros esta semana</span>
  </div>


 <div class="categories-wrapper">
    <h3 class="categories-title">Categorías</h3>
    <div class="categories-buttons-row">
      <button pButton 
        [class]="'category-button ' + (esCategoriaActiva('Todas') ? 'active-category' : '')"
        (click)="filtrarCategoria('Todas')">
        <i class="pi pi-book"></i>
        <span>Todas</span>
        <b>{{ contadorCategorias['Todas'] }}</b>
      </button>
      
      <button pButton 
        [class]="'category-button ' + (esCategoriaActiva('Sagradas Escrituras') ? 'active-category' : '')"
        (click)="filtrarCategoria('Sagradas Escrituras')">
        <i class="pi pi-plus"></i>
        <span>Sagradas Escrituras</span>
        <b>{{ contadorCategorias['Sagradas Escrituras'] }}</b>
      </button>
      
      <button pButton 
        [class]="'category-button ' + (esCategoriaActiva('Teología') ? 'active-category' : '')"
        (click)="filtrarCategoria('Teología')">
        <i class="pi pi-graduation-cap"></i>
        <span>Teología</span>
        <b>{{ contadorCategorias['Teología'] }}</b>
      </button>
      
      <button pButton 
        [class]="'category-button ' + (esCategoriaActiva('Devocionales') ? 'active-category' : '')"
        (click)="filtrarCategoria('Devocionales')">
        <i class="pi pi-heart"></i>
        <span>Devocionales</span>
        <b>{{ contadorCategorias['Devocionales'] }}</b>
      </button>
      
      <button pButton 
        [class]="'category-button ' + (esCategoriaActiva('Historia') ? 'active-category' : '')"
        (click)="filtrarCategoria('Historia')">
        <i class="pi pi-clock"></i>
        <span>Historia</span>
        <b>{{ contadorCategorias['Historia'] }}</b>
      </button>
      
      <button pButton 
        [class]="'category-button ' + (esCategoriaActiva('Himnarios') ? 'active-category' : '')"
        (click)="filtrarCategoria('Himnarios')">
        <i class="pi pi-music"></i>
        <span>Himnarios</span>
        <b>{{ contadorCategorias['Himnarios'] }}</b>
      </button>
      
      <button pButton 
        [class]="'category-button ' + (esCategoriaActiva('Oración') ? 'active-category' : '')"
        (click)="filtrarCategoria('Oración')">
        <i class="pi pi-star"></i>
        <span>Oración</span>
        <b>{{ contadorCategorias['Oración'] }}</b>
      </button>
      
      <button pButton 
        [class]="'category-button ' + (esCategoriaActiva('Biografías') ? 'active-category' : '')"
        (click)="filtrarCategoria('Biografías')">
        <i class="pi pi-user"></i>
        <span>Biografías</span>
        <b>{{ contadorCategorias['Biografías'] }}</b>
      </button>
    </div>
  </div>

  <div class="catalog-title">
    {{ categoriaSeleccionada === 'Todas' ? 'Catálogo Completo' : 'Categoría: ' + categoriaSeleccionada }} 
    ({{ librosFiltrados.length }} libro{{ librosFiltrados.length !== 1 ? 's' : '' }})
  </div>
  
  <div class="catalog-grid">
    <p-card *ngFor="let libro of librosFiltrados" class="book-card-compact">
      <ng-template pTemplate="header">
        <div class="book-image-container">
          <img [src]="libro.img" alt="portada" class="book-img-compact" />
          <span class="status-badge"
            [ngClass]="libro.estado === 'Disponible' ? 'available' : libro.estado === 'Prestado' ? 'borrowed' : 'repair'">
            {{ libro.estado }}
          </span>
        </div>
      </ng-template>
      
      <div class="book-info-compact">
        <h4 class="book-title-compact">{{ libro.titulo }}</h4>
        <p class="book-author-compact">{{ libro.autor }}</p>
        <span class="book-category-compact">{{ libro.categoria }}</span>
        
        <div class="book-details-compact">
          <span class="detail-item-compact"><i class="pi pi-tag"></i> {{ libro.catalogCode }}</span>
          <span class="detail-item-compact"><i class="pi pi-map-marker"></i> {{ libro.location }} - {{ libro.shelf }}</span>
          <span class="detail-item-compact"><i class="pi pi-calendar"></i> {{ libro.publishYear }}</span>
          <span class="detail-item-compact"><i class="pi pi-file"></i> {{ libro.pages }} páginas • {{ libro.format }}</span>
        </div>
      </div>

      <div class="book-actions-compact">
        <button pButton icon="pi pi-eye" class="action-btn-compact view-btn" pTooltip="Ver" (click)="verLibro(libro.id)"></button>
        <button pButton icon="pi pi-pencil" class="action-btn-compact edit-btn" pTooltip="Editar" (click)="editarLibro(libro.id)"></button>
        <button pButton icon="pi pi-trash" class="action-btn-compact delete-btn" pTooltip="Eliminar" (click)="eliminarLibro(libro.id)"></button>
      </div>
    </p-card>
  </div>
  
  <div *ngIf="librosFiltrados.length === 0" class="no-books-message">
    <i class="pi pi-info-circle"></i>
    <h3>No hay libros en esta categoría</h3>
    <p>La categoría "{{ categoriaSeleccionada }}" no contiene libros actualmente.</p>
  </div>
</div>
